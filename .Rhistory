long <- metadata %>%
map("longitude") %>%
as_tibble_col("Longitude") %>%
mutate(Longitude = round(as.double(Longitude), digits = 5))
long
long <- metadata %>%
map("longitude") %>%
as_tibble_col("Longitude") %>%
mutate(Longitude = as.double(Longitude, digits = 5))
long
data2 <- data %>%
mutate(Site = mdata$Site[match(File, metadata2$File)])
mdata
stations
source('~/Documents/Git/CTD Analysis/Scripts/Read_Data_From_Files.R')
stations
dates
source('~/Documents/Git/CTD Analysis/Scripts/Read_Data_From_Files.R')
# Mutating joing between data table and metadata table using file number for primary key.
data2 <- data %>%
mutate(Site = mdata$Site[match(File, mdata$File)]) %>%
select(Site,temperature)
data2
data2 <- data %>%
mutate(Site = mdata$Site[match(File, mdata$File)])
data2
data3 <- data %>%
left_join(mdata, by = "File")
str(data)
str(sites)
# extract the metadata from the metadata slot and put it in a tibble called metadata
metadata <- ctd_objects %>%
map("metadata", .id = "File") %>%
mutate(File = as.numeric(File))
str(metadata)
# extract the data slot from each ctd object and put it in a tibble called data
data <- map_dfr(ctd_objects, "data", .id = "FileNo") %>%
unlist() %>%
mutate(FileNo = as.numeric(FileNo))
data <- map_dfr(ctd_objects, "data", .id = "FileNo") %>%
unlist()
data
data <- map_dfr(ctd_objects, "data", .id = "FileNo") %>%
unlist(FileNo) %>%
mutate(FileNo = as.numeric(FileNo))
# extract the data slot from each ctd object and put it in a tibble called data
data <- map_dfr(ctd_objects, "data", .id = "FileNo") %>%
unlist(FileNo) %>%
mutate(FileNo = as.numeric(FileNo))
# extract the data slot from each ctd object and put it in a tibble called data
data <- map_dfr(ctd_objects, "data", .id = "FileNo") %>%
unlist(recursive = FALSE) %>%
mutate(FileNo = as.numeric(FileNo))
data
data <- map_dfr(ctd_objects, "data", .id = "FileNo") %>%
unlist(recursive = FALSE)
head(data)
sites <- metadata %>%
map("station") %>%
as_tibble_col("Site") %>%
mutate(Site = as.character(Site),
File = as.character(row_number()))
str(sites)
# extract the data slot from each ctd object and put it in a tibble called data
data <- map_dfr(ctd_objects, "data", .id = "File")
data3 <- data %>%
left_join(mdata, by = "File")
str(data)
str(sites)
sites
data
mdata <- tibble(dates, lat, long, sites)
data3 <- data %>%
left_join(mdata, by = "File")
data3
data3 <- data %>%
left_join(mdata, by = "File") %>%
relocate(Date, Time, Latitude, Longitude, Site)
library("dplyr")
data3 <- data %>%
left_join(mdata, by = "File") %>%
relocate(Date, Time, Latitude, Longitude, Site)
data3 <- data %>%
left_join(mdata, by = "File") %>%
select(Date, Time, Latitude, Longitude, Site, everything())
data3
data3
# Mutating joing between data table and metadata table using file number for primary key.
data3 <- data %>%
left_join(mdata, by = "File") %>%
select(Date, Time, Latitude, Longitude, Site, everything(), -File)
names(data3)
metadata[[1]][c("station", "date", "latitude", "longitude")]
metadata2 <- metadata %>%
map(`[`, c("date", "station", "latitude", "longitude"))
metadata2
str(metadata2)
metadata2 <- metadata %>%
map_dfr(`[`, c("date", "station", "latitude", "longitude"))
metadata2
medata <- metadata %>%
map_dfr(`[`, c("date", "station", "latitude", "longitude"), .id = "File")
medata
source('~/Documents/Git/CTD Analysis/Scripts/Read_Data_From_Files.R')
data3 <- data %>%
left_join(mdata, by = "File")
data3
# Join data and metadata using file number for primary key.
data3 <- data %>%
left_join(mdata, by = "File") %>%
select(date, latitude, longitude, station, everything(), -File)
data3
mdata <- metadata %>%
map_dfr(`[`, c("date", "station", "latitude", "longitude"), .id = "File") %>%
mutate(date = date(date),
time = strftime(date, format = "%H:%M:%S"),
site = station)
# Join data and metadata using file number for primary key.
data3 <- data %>%
left_join(mdata, by = "File") %>%
select(date, time, latitude, longitude, station, everything(), -File)
data3
data3$site
data3
mdata
mdata <- metadata %>%
map_dfr(`[`, c("date", "station", "latitude", "longitude"), .id = "File") %>%
mutate(date = date(date),
time = strftime(date, format = "%H:%M:%S"),
site = station) %>%
select(-station)
# Join data and metadata using file number for primary key.
data <- data %>%
left_join(mdata, by = "File") %>%
select(date, time, latitude, longitude, station, everything(), -File)
# Join data and metadata using file number for primary key.
data <- data %>%
left_join(mdata, by = "File") %>%
select(date, time, latitude, longitude, site, everything(), -File)
data
mdata <- metadata %>%
map_dfr(`[`, c("date", "station", "latitude", "longitude"), .id = "File") %>%
mutate(Date = date(date),
time = strftime(date, format = "%H:%M:%S"),
site = station) %>%
select(-station)
# Join data and metadata using file number for primary key.
data3 <- data %>%
left_join(mdata, by = "File") %>%
select(Date, time, latitude, longitude, site, everything(), -File)
mdata <- metadata %>%
map_dfr(`[`, c("date", "station", "latitude", "longitude"), .id = "File") %>%
mutate(Date = date(date),
time = strftime(date, format = "%H:%M:%S"),
site = station) %>%
select(-station)
mdata
# extract the data slot from each ctd object and put it in a tibble called data
data <- map_dfr(ctd_objects, "data", .id = "File")
# Join data and metadata using file number for primary key.
data3 <- data %>%
left_join(mdata, by = "File") %>%
select(Date, time, latitude, longitude, site, everything(), -File)
data3
mdata <- metadata %>%
map_dfr(`[`, c("date", "station", "latitude", "longitude"), .id = "File") %>%
mutate(Date = date(date),
time = hms(strftime(date, format = "%H:%M:%S")),
site = station) %>%
select(-station)
str(mdata)
# Join data and metadata using file number for primary key.
data3 <- data %>%
left_join(mdata, by = "File") %>%
select(Date, time, latitude, longitude, site, everything(), -File)
data3
mdata
mdata <- metadata %>%
map_dfr(`[`, c("date", "station", "latitude", "longitude"), .id = "File") %>%
mutate(Date = date(date),
time = hms(strftime(date, format = "%H:%M:%S")),
site = station) %>%
select(-station)
mdata
mdata <- metadata %>%
map_dfr(`[`, c("date", "station", "latitude", "longitude"), .id = "File") %>%
mutate(Date = date(date),
time = hms(strftime(date, format = "%H:%M:%S")),
site = station) %>%
select(Date, time, site, everything()-station)
mdata <- metadata %>%
map_dfr(`[`, c("date", "station", "latitude", "longitude"), .id = "File") %>%
mutate(Date = date(date),
time = hms(strftime(date, format = "%H:%M:%S")),
site = station) %>%
select(Date, time, site, everything(),-station)
mdata
mdata <- metadata %>%
map_dfr(`[`, c("date", "station", "latitude", "longitude"), .id = "File") %>%
mutate(Date = as_date(date),
time = hms(date),
site = station) %>%
select(Date, time, site, everything(),-station)
mdata <- metadata %>%
map_dfr(`[`, c("date", "station", "latitude", "longitude"), .id = "File") %>%
# mutate(Date = as_date(date),
#       time = hms(date),
#      site = station) %>%
#select(Date, time, site, everything(),-station)
# Join data and metadata using file number for primary key.
data3 <- data %>%
left_join(mdata, by = "File") %>%
select(Date, time, latitude, longitude, site, everything(), -File)
mdata <- metadata %>%
map_dfr(`[`, c("date", "station", "latitude", "longitude"), .id = "File")# %>%
mdata
separate(mdata$date, c("date", "time"), sep = " ")
mdata <- metadata %>%
map_dfr(`[`, c("date", "station", "latitude", "longitude"), .id = "File") %>%
as_tibble()
mdata
mdata <- metadata %>%
map_dfr(`[`, c("date", "station", "latitude", "longitude"), .id = "key") %>%
as_tibble()
separate(mdata$date, c("date", "time"), sep = " ")
metadata[[1]]["starttime"]
metadata[[1]]["start time"]
names(metadata)
str(metadata[1])
metadata[[1]]["starTime"]
metadata[[1]]["startTime"]
metadata[[1]]["date"]
source('~/Documents/Git/CTD Analysis/Scripts/Read_Data_From_Files.R')
# Join data and metadata using file number for primary key.
df <- data %>%
left_join(mdata, by = "key") %>%
select(date, time, latitude, longitude, site, everything(), -File)
# Join data and metadata using file number for primary key.
df <- data %>%
left_join(mdata, by = "key") %>%
select(date, latitude, longitude, site, everything(), -File)
# Join data and metadata using file number for primary key.
df <- data %>%
left_join(mdata, by = "key") %>%
select(date, latitude, longitude, station, everything(), -File)
# Join data and metadata using file number for primary key.
df <- data %>%
left_join(mdata, by = "key") %>%
select(date, latitude, longitude, station, everything(), -key)
df
mdata <- metadata %>%
map_dfr(`[`, c("date", "station", "latitude", "longitude"), .id = "key") %>%
mutate(Date = as_date(date),
time = strftime(date, format = "%H:%M:%S"),
site = station) %>%
select(Date, time, site, everything(),-station, -date)
mdata
mdata <- metadata %>%
map_dfr(`[`, c("date", "station", "latitude", "longitude"), .id = "key") %>%
mutate(Date = as_date(date),
time = strftime(date, format = "%H:%M:%S"),
site = station) %>%
select(key, Date, time, site, everything(),-station, -date)
# Join data and metadata using file number for primary key.
df <- data %>%
left_join(mdata, by = "key") %>%
select(date, latitude, longitude, station, everything(), -key)
# Join data and metadata using file number for primary key.
df <- data %>%
left_join(mdata, by = "key") %>%
select(Date, latitude, longitude, station, everything(), -key)
# Join data and metadata using file number for primary key.
df <- data %>%
left_join(mdata, by = "key") %>%
select(Date, latitude, longitude, site, everything(), -key)
df
# Join data and metadata using file number for primary key.
df <- data %>%
left_join(mdata, by = "key") %>%
select(Date, time, latitude, longitude, site, everything(), -key)
df
df
View(df)
group_by(df, depth)
# Join data and metadata using file number for primary key.
df <- data %>%
left_join(mdata, by = "key") %>%
select(Date, time, latitude, longitude, site, everything(),)
group_by(df, depth)
# Join data and metadata using file number for primary key.
df <- data %>%
left_join(mdata, by = "key") %>%
select(Date, time, latitude, longitude, site, everything())
names(df)
source('~/Documents/Git/CTD Analysis/Scripts/Read_Data_From_Files.R')
# Join data and metadata using file number for primary key.
df <- data %>%
left_join(mdata, by = "file") %>%
select(file, Date, time, latitude, longitude, site, everything())
mdata <- metadata %>%
map_dfr(`[`, c("date", "station", "latitude", "longitude"), .id = "file") %>%
mutate(Date = as_date(date),
time = strftime(date, format = "%H:%M:%S"),
site = station) %>%
select(key, Date, time, site, everything(),-station, -date)
# extract location, site names and dates from metadata
mdata <- metadata %>%
map_dfr(`[`, c("date", "station", "latitude", "longitude"), .id = "file") %>%
mutate(Date = as_date(date),
time = strftime(date, format = "%H:%M:%S"),
site = station) %>%
select(file, Date, time, site, everything(),-station, -date)
# Join data and metadata using file number for primary key.
df <- data %>%
left_join(mdata, by = "file") %>%
select(file, Date, time, latitude, longitude, site, everything())
group_by(df, file)
summary(df)
df
names(metadata)
names(metadata[[1]])
metadata[[1]][["deploymentType"]]
names(data[[1]])
names(ctd_objects[[1]])
names(ctd_objects[[1]])
ctd_objects[[1]])
ctd_objects[[1]]
ctd_objects[[1]][["flag"]]
701 <- read.ctd("RVJanan07501.cnv")
d7501 <- read.ctd("RVJanan07501.cnv")
d7501
summary(7501)
summary(d7501)
d08001 <- read.ctd("RVJanan08001.cnv")
summary(d08001)
d08001[[history]]
d08001[["history"]]
d08001["history"]
d08001[[3]]
d08001
d08001[[1]]
d08001[1]
d08001@metadata
d08001@processingLog
summary(d08001)
d08001[["method"]]
map(ctd_objects, ctdTrim(method = "downcast"))
x <- map_dfr(file.names, ctdTrim(read_ctd(), method = "downcast"))
x <- map_dfr(file.names, ctdTrim(read.ctd(), method = "downcast"))
for (file in list.files(pattern = ".cnv"))
plot(ctdTrim(read.oce(file)))
pdf("ctd.pdf")
for (file in list.files(pattern = ".cnv"))
plot(ctdTrim(read.oce(file)))
dev.off()
ctdTrim(d08001, method = "downcast")
here()
setwd(xx)
setwd(..)
setwd(../)
setwd(./)
setwd("~/Documents/Git/CTD Analysis")
here()
getwd()
set_here()
here()
here()
library(here)
# get a the names of .cnv files in the data folder and put them in a vector called temp
file.names <- list.files(path = here("Data"),pattern = "*.cnv")
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd("Data"))
library("tidyverse")
library("here")
library("oce")
library("lubridate")
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd("Data"))
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd(path = here("Data"))
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd(path = here("Data")))
here("Data")
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd(path = here("Data")))
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd())
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd, path = here("Data"))
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd, path = "./Data")
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd, path = "/Data")
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd, path = "\Data")
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd, path = "./Data")
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd, path = "here(Data)")
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd, path = here("Data"))
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd)
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd, path = here("Data"))
read.ctd(path =)
read.ctd(path = here("Data", pattern = "*.cnv"))
here()
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd)
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd, "path = here(""Data"")")
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd, "path = here("Data)")
# extract the data slot from each ctd object and put it in a tibble called data
data <- map_dfr(ctd_objects, "data", .id = "file")
# extract the metadata from the metadata slot from each octd bject and put it in a tibble called metadata
metadata <- ctd_objects %>%
map("metadata")
# extract location, site names and dates from metadata
mdata <- metadata %>%
map_dfr(`[`, c("date", "station", "latitude", "longitude"), .id = "file") %>%
mutate(Date = as_date(date),
time = strftime(date, format = "%H:%M:%S"),
site = station) %>%
select(file, Date, time, site, everything(),-station, -date)
# Join data and metadata using file number for primary key.
df <- data %>%
left_join(mdata, by = "file") %>%
select(file, Date, time, latitude, longitude, site, everything())
ctd_objects <- map(file.names, read.ctd, "path = here("Data")")
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd, ..., path = here("Data"))
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd, .., path = here("Data"))
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd, ., path = here("Data"))
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd, path = here("Data"))
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd)
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd, (path = here("Data")))
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd, (path = "/Data"))
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd, path = "/Data")
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd, file, path = "/Data")
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd, file, .path = "/Data")
library("tidyverse")
library("here")
library("oce")
library("lubridate")
# set the working directory to the top level of the project
here()
# get a the names of .cnv files in the data folder and put them in a vector called temp
file.names <- list.files(path = here("Data"), pattern = "*.cnv")
# read the data into a list of lists called ctd_objects
ctd_objects <- map(file.names, read.ctd, file, path = "/Data")
# read the data into a list of lists called ctd_objects
ctd_objects <-
here("Data") %>%
map(file.names, read.ctd, file)
ctd_objects
# read the data into a list of lists called ctd_objects
ctd_objects <-
here("Data") %>%
map(file.names, read.ctd)
ctd_objects <-
here("Data") %>%
map(file.names, read.ctd)
# read the data into a list of lists called ctd_objects
ctd_objects <-
map(file.names, read.ctd, list(path = "./Data"))
# read the data into a list of lists called ctd_objects
ctd_objects <-
map(file.names, read.ctd, list(path = here("Data")))
# read the data into a list of lists called ctd_objects
ctd_objects <-
map(file.names, read.ctd, path = ".\Data")
# read the data into a list of lists called ctd_objects
ctd_objects <-
map(file.names, read.ctd, path = "./Data")
# read the data into a list of lists called ctd_objects
ctd_objects <-
map(file.names, read.ctd, path = ./Data)
# read the data into a list of lists called ctd_objects
ctd_objects <-
map(file.names, read.ctd, path = /Data)
# read the data into a list of lists called ctd_objects
ctd_objects <-
map(file.names, read.ctd, path = "/Data")
read.ctd(path = "/Data", file = "RVJanan07501.cnv")
read.ctd(file = "RVJanan07501.cnv", path = "/Data")
read.ctd(file = "RVJanan07501.cnv", path = "./Data")
read.ctd(file = "RVJanan07501.cnv")
# read the data into a list of lists called ctd_objects
setwd(here("Data"))
getwd()
# read the data into a list of lists called ctd_objects
setwd(here("Data"))
ctd_objects <- read.ctd("*.cnv")
ctd_objects <- map(file.names, read.ctd)
source('~/Documents/Git/CTD Analysis/Scripts/Read_Data_From_Files.R')
df
getwd()
here
here()
setwd(here())
getwd()
